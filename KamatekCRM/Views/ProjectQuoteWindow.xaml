<Window x:Class="KamatekCrm.Views.ProjectQuoteWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="ðŸ—ï¸ PROJE &amp; TEKLÄ°F OLUÅžTUR" 
        Height="650" Width="900"
        WindowStartupLocation="CenterScreen"
        Background="{DynamicResource ThemeBackground}">
    
    <Grid Margin="20">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>
        
        <!-- Header -->
        <Border Grid.Row="0" Background="#1565C0" CornerRadius="8" Padding="20,15" Margin="0,0,0,15">
            <StackPanel>
                <TextBlock Text="ðŸ—ï¸ PROJE &amp; TEKLÄ°F OLUÅžTUR" 
                           FontSize="22" FontWeight="Bold" Foreground="White"/>
                <TextBlock Text="MÃ¼ÅŸteri seÃ§in, yapÄ± tanÄ±mlayÄ±n ve teklif hazÄ±rlayÄ±n" 
                           FontSize="12" Foreground="#E3F2FD" Margin="0,5,0,0"/>
            </StackPanel>
        </Border>
        
        <!-- TabControl -->
        <TabControl Grid.Row="1" Margin="0,0,0,15">
            
            <!-- TAB 1: KeÅŸif & YapÄ± -->
            <TabItem Header="ðŸ“‹ KEÅžÄ°F &amp; YAPI" Padding="15,8">
                <ScrollViewer VerticalScrollBarVisibility="Auto">
                    <StackPanel Margin="20">
                        
                        <!-- MÃ¼ÅŸteri SeÃ§imi -->
                        <TextBlock Text="MÃœÅžTERÄ°" FontWeight="SemiBold" FontSize="12" 
                                   Foreground="#757575" Margin="0,0,0,8"/>
                        <ComboBox ItemsSource="{Binding Customers}"
                                  SelectedItem="{Binding SelectedCustomer}"
                                  DisplayMemberPath="FullName"
                                  Height="40" FontSize="14"/>
                        
                        <!-- Proje AdÄ± -->
                        <TextBlock Text="PROJE ADI" FontWeight="SemiBold" FontSize="12" 
                                   Foreground="#757575" Margin="0,20,0,8"/>
                        <TextBox Text="{Binding ProjectName, UpdateSourceTrigger=PropertyChanged}"
                                 Height="40" FontSize="14" Padding="10,8"/>
                        
                        <!-- YapÄ± TanÄ±mÄ± -->
                        <Border Background="White" CornerRadius="8" Padding="20" Margin="0,25,0,0"
                                BorderBrush="#E0E0E0" BorderThickness="1">
                            <StackPanel>
                                <TextBlock Text="ðŸ¢ YAPI TANIMI" FontWeight="Bold" FontSize="14" 
                                           Foreground="#1565C0" Margin="0,0,0,15"/>
                                
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="*"/>
                                    </Grid.ColumnDefinitions>
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="Auto"/>
                                    </Grid.RowDefinitions>
                                    
                                    <!-- Blok SayÄ±sÄ± -->
                                    <StackPanel Grid.Column="0" Margin="0,0,10,0">
                                        <TextBlock Text="Blok SayÄ±sÄ±" FontSize="11" Foreground="#757575"/>
                                        <TextBox Text="{Binding BlockCount, UpdateSourceTrigger=PropertyChanged}"
                                                 Height="45" FontSize="18" TextAlignment="Center"
                                                 FontWeight="SemiBold" Margin="0,5,0,0"/>
                                    </StackPanel>
                                    
                                    <!-- Kat SayÄ±sÄ± -->
                                    <StackPanel Grid.Column="1" Margin="5,0">
                                        <TextBlock Text="Kat SayÄ±sÄ±" FontSize="11" Foreground="#757575"/>
                                        <TextBox Text="{Binding FloorCount, UpdateSourceTrigger=PropertyChanged}"
                                                 Height="45" FontSize="18" TextAlignment="Center"
                                                 FontWeight="SemiBold" Margin="0,5,0,0"/>
                                    </StackPanel>
                                    
                                    <!-- Daire/Kat -->
                                    <StackPanel Grid.Column="2" Margin="10,0,0,0">
                                        <TextBlock Text="Daire / Kat" FontSize="11" Foreground="#757575"/>
                                        <TextBox Text="{Binding FlatsPerFloor, UpdateSourceTrigger=PropertyChanged}"
                                                 Height="45" FontSize="18" TextAlignment="Center"
                                                 FontWeight="SemiBold" Margin="0,5,0,0"/>
                                    </StackPanel>
                                </Grid>
                                
                                <!-- Toplam Birim -->
                                <Border Background="#E3F2FD" CornerRadius="6" Padding="15,12" Margin="0,20,0,0">
                                    <StackPanel Orientation="Horizontal" HorizontalAlignment="Center">
                                        <TextBlock Text="ðŸ“Š TOPLAM BÄ°RÄ°M: " FontSize="16" 
                                                   FontWeight="SemiBold" Foreground="#1565C0"/>
                                        <TextBlock Text="{Binding TotalUnitCount}" FontSize="24" 
                                                   FontWeight="Bold" Foreground="#0D47A1"/>
                                    </StackPanel>
                                </Border>
                            </StackPanel>
                        </Border>
                        
                    </StackPanel>
                </ScrollViewer>
            </TabItem>
            
            <!-- TAB 2: Teklif HazÄ±rla -->
            <TabItem Header="ðŸ’° TEKLÄ°F HAZIRLA" Padding="15,8">
                <Grid Margin="10">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="300"/>
                        <ColumnDefinition Width="*"/>
                    </Grid.ColumnDefinitions>
                    
                    <!-- Sol: ÃœrÃ¼n KataloÄŸu -->
                    <Border Grid.Column="0" Background="White" CornerRadius="8" 
                            BorderBrush="#E0E0E0" BorderThickness="1" Margin="0,0,10,0">
                        <Grid>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="*"/>
                                <RowDefinition Height="Auto"/>
                            </Grid.RowDefinitions>
                            
                            <TextBlock Grid.Row="0" Text="ðŸ“¦ ÃœRÃœN KATALOÄžU" 
                                       FontWeight="Bold" FontSize="13"
                                       Foreground="#1565C0" Margin="15,12"/>
                            
                            <ListBox Grid.Row="1" ItemsSource="{Binding Products}"
                                     SelectedItem="{Binding SelectedProduct}"
                                     BorderThickness="0" Margin="10,0">
                                <ListBox.ItemTemplate>
                                    <DataTemplate>
                                        <StackPanel Margin="5,8">
                                            <TextBlock Text="{Binding ProductName}" FontWeight="SemiBold"/>
                                            <TextBlock Text="{Binding SalePrice, StringFormat='{}{0:C}'}" 
                                                       FontSize="11" Foreground="#4CAF50"/>
                                        </StackPanel>
                                    </DataTemplate>
                                </ListBox.ItemTemplate>
                            </ListBox>
                            
                            <!-- Ekle Butonu -->
                            <Border Grid.Row="2" Padding="10" Background="#FAFAFA"
                                    BorderBrush="#E0E0E0" BorderThickness="0,1,0,0">
                                <StackPanel>
                                    <StackPanel Orientation="Horizontal" Margin="0,0,0,8">
                                        <TextBlock Text="Adet/Birim:" VerticalAlignment="Center" 
                                                   FontSize="12" Margin="0,0,10,0"/>
                                        <TextBox Text="{Binding QtyPerUnit, UpdateSourceTrigger=PropertyChanged}"
                                                 Width="60" Height="30" TextAlignment="Center"/>
                                    </StackPanel>
                                    <Button Content="âž• TEKLÄ°FE EKLE" 
                                            Command="{Binding AddToQuoteCommand}"
                                            Background="#4CAF50" Foreground="White"
                                            FontWeight="SemiBold" Height="35"
                                            BorderThickness="0" Cursor="Hand"/>
                                </StackPanel>
                            </Border>
                        </Grid>
                    </Border>
                    
                    <!-- SaÄŸ: Teklif Kalemleri -->
                    <Border Grid.Column="1" Background="White" CornerRadius="8"
                            BorderBrush="#E0E0E0" BorderThickness="1">
                        <Grid>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="*"/>
                                <RowDefinition Height="Auto"/>
                            </Grid.RowDefinitions>
                            
                            <TextBlock Grid.Row="0" Text="ðŸ“‹ TEKLÄ°F KALEMLERÄ°" 
                                       FontWeight="Bold" FontSize="13"
                                       Foreground="#1565C0" Margin="15,12"/>
                            
                            <DataGrid Grid.Row="1" ItemsSource="{Binding QuoteItems}"
                                      SelectedItem="{Binding SelectedQuoteItem}"
                                      AutoGenerateColumns="False"
                                      CanUserAddRows="False"
                                      IsReadOnly="True"
                                      BorderThickness="0"
                                      GridLinesVisibility="Horizontal"
                                      HeadersVisibility="Column">
                                <DataGrid.Columns>
                                    <DataGridTextColumn Header="ÃœrÃ¼n" Binding="{Binding ProductName}" Width="*"/>
                                    <DataGridTextColumn Header="Birim Fiyat" Binding="{Binding UnitPrice, StringFormat='{}{0:C}'}" Width="100"/>
                                    <DataGridTextColumn Header="Adet/Birim" Binding="{Binding QtyPerUnit}" Width="80"/>
                                    <DataGridTextColumn Header="Toplam Adet" Binding="{Binding TotalQuantity}" Width="90"/>
                                    <DataGridTextColumn Header="Toplam" Binding="{Binding TotalPrice, StringFormat='{}{0:C}'}" Width="100"/>
                                </DataGrid.Columns>
                            </DataGrid>
                            
                            <!-- Alt: Toplam ve KaldÄ±r -->
                            <Border Grid.Row="2" Background="#FAFAFA" Padding="15"
                                    BorderBrush="#E0E0E0" BorderThickness="0,1,0,0">
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="Auto"/>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="Auto"/>
                                    </Grid.ColumnDefinitions>
                                    
                                    <Button Grid.Column="0" Content="ðŸ—‘ï¸ KaldÄ±r"
                                            Command="{Binding RemoveFromQuoteCommand}"
                                            Background="#EF5350" Foreground="White"
                                            Padding="15,8" BorderThickness="0"/>
                                    
                                    <StackPanel Grid.Column="2" Orientation="Horizontal" VerticalAlignment="Center">
                                        <TextBlock Text="GENEL TOPLAM: " FontSize="16" FontWeight="SemiBold"/>
                                        <TextBlock Text="{Binding TotalAmount, StringFormat='{}{0:C}'}" 
                                                   FontSize="20" FontWeight="Bold" Foreground="#4CAF50"/>
                                    </StackPanel>
                                </Grid>
                            </Border>
                        </Grid>
                    </Border>
                    
                </Grid>
            </TabItem>
        </TabControl>
        
        <!-- Footer Buttons -->
        <StackPanel Grid.Row="2" Orientation="Horizontal" HorizontalAlignment="Right">
            <Button Content="âŒ Ä°PTAL" 
                    Command="{Binding CancelCommand}"
                    CommandParameter="{Binding RelativeSource={RelativeSource AncestorType=Window}}"
                    Background="#9E9E9E" Foreground="White"
                    FontWeight="SemiBold" Padding="25,12"
                    Margin="0,0,10,0" BorderThickness="0" Cursor="Hand"/>
            
            <Button Content="ðŸ’¾ KAYDET" 
                    Command="{Binding SaveCommand}"
                    Background="#4CAF50" Foreground="White"
                    FontWeight="Bold" FontSize="14" Padding="30,12"
                    BorderThickness="0" Cursor="Hand"/>
        </StackPanel>
    </Grid>
</Window>
