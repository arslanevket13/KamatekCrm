<UserControl x:Class="KamatekCrm.Views.SystemLogsView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:vm="clr-namespace:KamatekCrm.ViewModels"
             Background="{StaticResource BackgroundColor}">
    
    <UserControl.DataContext>
        <vm:SystemLogsViewModel/>
    </UserControl.DataContext>

    <Grid Margin="20">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>

        <!-- Header -->
        <StackPanel Grid.Row="0" Margin="0,0,0,20">
            <TextBlock Text="ðŸ“‹ Sistem LoglarÄ±" 
                       FontSize="28" FontWeight="Bold"
                       Foreground="{StaticResource TextPrimaryColor}"/>
            <TextBlock Text="TÃ¼m kullanÄ±cÄ± iÅŸlemlerini gÃ¶rÃ¼ntÃ¼le ve denetle"
                       FontSize="12" Foreground="#757575" Margin="0,4,0,0"/>
        </StackPanel>

        <!-- Filters -->
        <Border Grid.Row="1" Style="{StaticResource CardPanel}" Padding="16" Margin="0,0,0,16">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>

                <!-- Search -->
                <Grid Grid.Column="0" Margin="0,0,12,0">
                    <TextBox Text="{Binding SearchText, UpdateSourceTrigger=PropertyChanged}"
                             Style="{StaticResource ModernTextBox}"
                             Height="36" Padding="36,8,12,8"/>
                    <TextBlock Text="ðŸ”" FontSize="14" VerticalAlignment="Center" 
                               Margin="12,0,0,0" IsHitTestVisible="False"/>
                </Grid>

                <!-- Action Filter -->
                <StackPanel Grid.Column="1" Margin="0,0,12,0">
                    <TextBlock Text="Ä°ÅŸlem Tipi" FontSize="10" Foreground="#757575" Margin="0,0,0,2"/>
                    <ComboBox ItemsSource="{Binding ActionTypes}"
                              SelectedItem="{Binding SelectedActionFilter}"
                              Width="120" Height="36"/>
                </StackPanel>

                <!-- Entity Filter -->
                <StackPanel Grid.Column="2" Margin="0,0,12,0">
                    <TextBlock Text="Entity" FontSize="10" Foreground="#757575" Margin="0,0,0,2"/>
                    <ComboBox ItemsSource="{Binding EntityTypes}"
                              SelectedItem="{Binding SelectedEntityFilter}"
                              Width="120" Height="36"/>
                </StackPanel>

                <!-- Date Range -->
                <StackPanel Grid.Column="3" Margin="0,0,12,0">
                    <TextBlock Text="BaÅŸlangÄ±Ã§" FontSize="10" Foreground="#757575" Margin="0,0,0,2"/>
                    <DatePicker SelectedDate="{Binding StartDate}" Width="120" Height="36"/>
                </StackPanel>

                <StackPanel Grid.Column="4" Margin="0,0,12,0">
                    <TextBlock Text="BitiÅŸ" FontSize="10" Foreground="#757575" Margin="0,0,0,2"/>
                    <DatePicker SelectedDate="{Binding EndDate}" Width="120" Height="36"/>
                </StackPanel>

                <!-- Buttons -->
                <StackPanel Grid.Column="5" Orientation="Horizontal" VerticalAlignment="Bottom">
                    <Button Content="ðŸ—‘ï¸ Temizle"
                            Style="{StaticResource SecondaryButton}"
                            Command="{Binding ClearFiltersCommand}"
                            Height="36" Padding="12,0" Margin="0,0,8,0"/>
                    <Button Content="ðŸ”„ Yenile"
                            Style="{StaticResource ModernButton}"
                            Command="{Binding RefreshCommand}"
                            Height="36" Padding="12,0"/>
                </StackPanel>
            </Grid>
        </Border>

        <!-- Logs Grid -->
        <Border Grid.Row="2" Style="{StaticResource CardPanel}" Padding="0">
            <DataGrid ItemsSource="{Binding Logs}"
                      Style="{StaticResource ModernDataGrid}"
                      ColumnHeaderStyle="{StaticResource ModernDataGridColumnHeader}"
                      AutoGenerateColumns="False"
                      IsReadOnly="True"
                      SelectionMode="Single"
                      RowHeight="45">
                
                <DataGrid.Columns>
                    <!-- Timestamp -->
                    <DataGridTextColumn Header="Tarih/Saat" 
                                        Binding="{Binding Timestamp, StringFormat=dd.MM.yyyy HH:mm:ss}" 
                                        Width="150">
                        <DataGridTextColumn.ElementStyle>
                            <Style TargetType="TextBlock">
                                <Setter Property="VerticalAlignment" Value="Center"/>
                                <Setter Property="Margin" Value="12,0"/>
                                <Setter Property="Foreground" Value="#616161"/>
                                <Setter Property="FontFamily" Value="Consolas"/>
                            </Style>
                        </DataGridTextColumn.ElementStyle>
                    </DataGridTextColumn>

                    <!-- User -->
                    <DataGridTextColumn Header="KullanÄ±cÄ±" 
                                        Binding="{Binding Username}" 
                                        Width="120">
                        <DataGridTextColumn.ElementStyle>
                            <Style TargetType="TextBlock">
                                <Setter Property="VerticalAlignment" Value="Center"/>
                                <Setter Property="Margin" Value="12,0"/>
                                <Setter Property="FontWeight" Value="SemiBold"/>
                            </Style>
                        </DataGridTextColumn.ElementStyle>
                    </DataGridTextColumn>

                    <!-- Action Type -->
                    <DataGridTemplateColumn Header="Ä°ÅŸlem" Width="130">
                        <DataGridTemplateColumn.CellTemplate>
                            <DataTemplate>
                                <Border CornerRadius="12" Padding="8,4" HorizontalAlignment="Left" Margin="12,0">
                                    <Border.Style>
                                        <Style TargetType="Border">
                                            <Setter Property="Background" Value="#E0E0E0"/>
                                            <Style.Triggers>
                                                <DataTrigger Binding="{Binding ActionType}" Value="Login">
                                                    <Setter Property="Background" Value="#E8F5E9"/>
                                                </DataTrigger>
                                                <DataTrigger Binding="{Binding ActionType}" Value="Logout">
                                                    <Setter Property="Background" Value="#FFF3E0"/>
                                                </DataTrigger>
                                                <DataTrigger Binding="{Binding ActionType}" Value="Create">
                                                    <Setter Property="Background" Value="#E3F2FD"/>
                                                </DataTrigger>
                                                <DataTrigger Binding="{Binding ActionType}" Value="Delete">
                                                    <Setter Property="Background" Value="#FFEBEE"/>
                                                </DataTrigger>
                                                <DataTrigger Binding="{Binding ActionType}" Value="PasswordChange">
                                                    <Setter Property="Background" Value="#F3E5F5"/>
                                                </DataTrigger>
                                                <DataTrigger Binding="{Binding ActionType}" Value="PasswordReset">
                                                    <Setter Property="Background" Value="#FCE4EC"/>
                                                </DataTrigger>
                                            </Style.Triggers>
                                        </Style>
                                    </Border.Style>
                                    <TextBlock FontSize="11" FontWeight="SemiBold">
                                        <Run Text="{Binding ActionIcon, Mode=OneWay}"/>
                                        <Run Text=" "/>
                                        <Run Text="{Binding ActionTypeDisplay, Mode=OneWay}"/>
                                    </TextBlock>
                                </Border>
                            </DataTemplate>
                        </DataGridTemplateColumn.CellTemplate>
                    </DataGridTemplateColumn>

                    <!-- Entity -->
                    <DataGridTextColumn Header="Entity" 
                                        Binding="{Binding EntityName}" 
                                        Width="100">
                        <DataGridTextColumn.ElementStyle>
                            <Style TargetType="TextBlock">
                                <Setter Property="VerticalAlignment" Value="Center"/>
                                <Setter Property="Margin" Value="12,0"/>
                                <Setter Property="Foreground" Value="#9E9E9E"/>
                            </Style>
                        </DataGridTextColumn.ElementStyle>
                    </DataGridTextColumn>

                    <!-- Record ID -->
                    <DataGridTextColumn Header="ID" 
                                        Binding="{Binding RecordId}" 
                                        Width="60">
                        <DataGridTextColumn.ElementStyle>
                            <Style TargetType="TextBlock">
                                <Setter Property="VerticalAlignment" Value="Center"/>
                                <Setter Property="Margin" Value="12,0"/>
                                <Setter Property="FontFamily" Value="Consolas"/>
                                <Setter Property="Foreground" Value="#9E9E9E"/>
                            </Style>
                        </DataGridTextColumn.ElementStyle>
                    </DataGridTextColumn>

                    <!-- Description -->
                    <DataGridTextColumn Header="AÃ§Ä±klama" 
                                        Binding="{Binding Description}" 
                                        Width="*" MinWidth="250">
                        <DataGridTextColumn.ElementStyle>
                            <Style TargetType="TextBlock">
                                <Setter Property="VerticalAlignment" Value="Center"/>
                                <Setter Property="Margin" Value="12,0"/>
                                <Setter Property="TextTrimming" Value="CharacterEllipsis"/>
                            </Style>
                        </DataGridTextColumn.ElementStyle>
                    </DataGridTextColumn>
                </DataGrid.Columns>
            </DataGrid>
        </Border>
    </Grid>
</UserControl>
