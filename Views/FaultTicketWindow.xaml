<Window x:Class="KamatekCrm.Views.FaultTicketWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:vm="clr-namespace:KamatekCrm.ViewModels"
        mc:Ignorable="d"
        Title="ðŸ“‹ Yeni ArÄ±za KaydÄ±" 
        Width="1200" Height="700"
        WindowStartupLocation="CenterOwner"
        Background="#1a1a2e">

    <Window.DataContext>
        <vm:FaultTicketViewModel/>
    </Window.DataContext>

    <Window.Resources>
        <BooleanToVisibilityConverter x:Key="BoolToVis"/>
        
        <!-- Modern White Card -->
        <Style x:Key="WhiteCard" TargetType="Border">
            <Setter Property="Background" Value="#FFFFFF"/>
            <Setter Property="CornerRadius" Value="12"/>
            <Setter Property="Padding" Value="20"/>
            <Setter Property="Effect">
                <Setter.Value>
                    <DropShadowEffect BlurRadius="25" ShadowDepth="3" Opacity="0.15" Color="Black"/>
                </Setter.Value>
            </Setter>
        </Style>
        
        <!-- Light Gray Card -->
        <Style x:Key="GrayCard" TargetType="Border">
            <Setter Property="Background" Value="#F5F5F5"/>
            <Setter Property="CornerRadius" Value="12"/>
            <Setter Property="Padding" Value="20"/>
            <Setter Property="Effect">
                <Setter.Value>
                    <DropShadowEffect BlurRadius="20" ShadowDepth="2" Opacity="0.1" Color="Black"/>
                </Setter.Value>
            </Setter>
        </Style>
        
        <!-- Section Header -->
        <Style x:Key="SectionHeader" TargetType="TextBlock">
            <Setter Property="FontSize" Value="15"/>
            <Setter Property="FontWeight" Value="Bold"/>
            <Setter Property="Foreground" Value="#2c3e50"/>
            <Setter Property="Margin" Value="0,0,0,16"/>
        </Style>
        
        <!-- Field Label -->
        <Style x:Key="FieldLabel" TargetType="TextBlock">
            <Setter Property="FontSize" Value="12"/>
            <Setter Property="Foreground" Value="#7f8c8d"/>
            <Setter Property="Margin" Value="0,0,0,6"/>
        </Style>
        
        <!-- Modern Input -->
        <Style x:Key="ModernInput" TargetType="TextBox">
            <Setter Property="Background" Value="White"/>
            <Setter Property="BorderBrush" Value="#ddd"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="Padding" Value="12,10"/>
            <Setter Property="FontSize" Value="13"/>
            <Setter Property="Foreground" Value="#2c3e50"/>
            <Style.Triggers>
                <Trigger Property="IsFocused" Value="True">
                    <Setter Property="BorderBrush" Value="#3498db"/>
                </Trigger>
            </Style.Triggers>
        </Style>
        
        <!-- Category Button -->
        <Style x:Key="CategoryButton" TargetType="RadioButton">
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="RadioButton">
                        <Border x:Name="border" Background="#f8f9fa" BorderBrush="#ddd" BorderThickness="1" 
                                CornerRadius="8" Padding="16,12" Cursor="Hand">
                            <ContentPresenter HorizontalAlignment="Center"/>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsChecked" Value="True">
                                <Setter TargetName="border" Property="Background" Value="#3498db"/>
                                <Setter TargetName="border" Property="BorderBrush" Value="#2980b9"/>
                            </Trigger>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter TargetName="border" Property="Background" Value="#ecf0f1"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
    </Window.Resources>

    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>
        
        <!-- ========== HEADER ========== -->
        <Border Grid.Row="0" Background="#252541" Padding="24,16">
            <Grid>
                <StackPanel Orientation="Horizontal">
                    <TextBlock Text="ðŸ“‹" FontSize="24" VerticalAlignment="Center" Margin="0,0,12,0"/>
                    <StackPanel>
                        <TextBlock Text="YENÄ° ARIZA KAYDI" FontSize="20" FontWeight="Bold" Foreground="White"/>
                        <TextBlock Text="Cihaz arÄ±za bilgilerini hÄ±zlÄ±ca kaydedin" FontSize="12" Foreground="#888" Margin="0,2,0,0"/>
                    </StackPanel>
                </StackPanel>
                
                <!-- Ã–ncelik Badge -->
                <StackPanel Orientation="Horizontal" HorizontalAlignment="Right" VerticalAlignment="Center">
                    <TextBlock Text="Ã–ncelik:" Foreground="#888" FontSize="12" VerticalAlignment="Center" Margin="0,0,8,0"/>
                    <ComboBox ItemsSource="{Binding Priorities}"
                             SelectedItem="{Binding SelectedPriority}"
                             Background="#1a1a2e" Foreground="White"
                             BorderBrush="#3498db" BorderThickness="1"
                             Width="120" Height="32" Padding="8,4"/>
                </StackPanel>
            </Grid>
        </Border>

        <!-- ========== 3-COLUMN MAIN CONTENT ========== -->
        <Grid Grid.Row="1" Margin="20">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="16"/>
                <ColumnDefinition Width="1.2*"/>
                <ColumnDefinition Width="16"/>
                <ColumnDefinition Width="*"/>
            </Grid.ColumnDefinitions>

            <!-- ===== SOL PANEL: MÃœÅžTERÄ° ===== -->
            <Border Grid.Column="0" Style="{StaticResource GrayCard}">
                <StackPanel>
                    <TextBlock Style="{StaticResource SectionHeader}">
                        <Run Text="ðŸ‘¤" FontSize="18"/>
                        <Run Text=" MÃœÅžTERÄ° BÄ°LGÄ°LERÄ°"/>
                    </TextBlock>
                    
                    <!-- MÃ¼ÅŸteri Arama -->
                    <TextBlock Style="{StaticResource FieldLabel}" Text="MÃ¼ÅŸteri SeÃ§in *"/>
                    <ComboBox ItemsSource="{Binding Customers}"
                             SelectedItem="{Binding SelectedCustomer}"
                             DisplayMemberPath="FullName"
                             IsEditable="True"
                             IsTextSearchEnabled="True"
                             Background="White" Foreground="#2c3e50"
                             BorderBrush="#ddd" BorderThickness="1"
                             Height="40" Padding="10,8" Margin="0,0,0,12"/>
                    
                    <!-- MÃ¼ÅŸteri Adres -->
                    <Border Background="#e8f4fc" CornerRadius="6" Padding="10" Margin="0,0,0,16">
                        <TextBlock Text="{Binding CustomerAddress}" 
                                  TextWrapping="Wrap" FontSize="11" Foreground="#555"/>
                    </Border>
                    
                    <!-- HÄ±zlÄ± MÃ¼ÅŸteri Ekle Toggle -->
                    <Border Background="#fff3e0" CornerRadius="8" Padding="12" Margin="0,0,0,12">
                        <CheckBox Content="âš¡ HÄ±zlÄ± MÃ¼ÅŸteri Ekle" 
                                 IsChecked="{Binding IsQuickAddCustomer}"
                                 FontSize="13" FontWeight="SemiBold" Foreground="#e65100"/>
                    </Border>
                    
                    <!-- HÄ±zlÄ± Ekle AlanlarÄ± -->
                    <StackPanel Visibility="{Binding IsQuickAddCustomer, Converter={StaticResource BoolToVis}}">
                        <TextBlock Style="{StaticResource FieldLabel}" Text="Ad Soyad"/>
                        <TextBox Text="{Binding QuickCustomerName, UpdateSourceTrigger=PropertyChanged}"
                                Style="{StaticResource ModernInput}" Margin="0,0,0,12"/>
                        
                        <TextBlock Style="{StaticResource FieldLabel}" Text="Telefon"/>
                        <TextBox Text="{Binding QuickCustomerPhone, UpdateSourceTrigger=PropertyChanged}"
                                Style="{StaticResource ModernInput}"/>
                    </StackPanel>
                </StackPanel>
            </Border>

            <!-- ===== ORTA PANEL: CÄ°HAZ ===== -->
            <Border Grid.Column="2" Style="{StaticResource WhiteCard}">
                <StackPanel>
                    <TextBlock Style="{StaticResource SectionHeader}">
                        <Run Text="ðŸ“±" FontSize="18"/>
                        <Run Text=" CÄ°HAZ BÄ°LGÄ°LERÄ°"/>
                    </TextBlock>
                    
                    <!-- Ana Kategori -->
                    <TextBlock Style="{StaticResource FieldLabel}" Text="Ana Kategori *"/>
                    <Grid Margin="0,0,0,16">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="8"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>
                        
                        <RadioButton Grid.Column="0" GroupName="Category" 
                                    IsChecked="{Binding IsCameraCategory}"
                                    Style="{StaticResource CategoryButton}">
                            <StackPanel Orientation="Horizontal">
                                <TextBlock Text="ðŸ“¹" FontSize="18" Margin="0,0,8,0"/>
                                <TextBlock Text="Kamera" FontWeight="SemiBold" Foreground="#2c3e50"/>
                            </StackPanel>
                        </RadioButton>
                        
                        <RadioButton Grid.Column="2" GroupName="Category"
                                    IsChecked="{Binding IsDiafonCategory}"
                                    Style="{StaticResource CategoryButton}">
                            <StackPanel Orientation="Horizontal">
                                <TextBlock Text="ðŸ””" FontSize="18" Margin="0,0,8,0"/>
                                <TextBlock Text="Diafon" FontWeight="SemiBold" Foreground="#2c3e50"/>
                            </StackPanel>
                        </RadioButton>
                    </Grid>
                    
                    <!-- Cihaz Tipi (Manuel GiriÅŸ Destekli) -->
                    <TextBlock Style="{StaticResource FieldLabel}" Text="Cihaz Tipi *"/>
                    <ComboBox IsEditable="True"
                             Text="{Binding SelectedDeviceTypeName, UpdateSourceTrigger=PropertyChanged}"
                             ItemsSource="{Binding DeviceTypeOptions}"
                             Background="White" Foreground="#2c3e50"
                             BorderBrush="#ddd" BorderThickness="1"
                             Height="40" Padding="10,8" Margin="0,0,0,16"/>
                    
                    <!-- Marka / Model -->
                    <Grid Margin="0,0,0,16">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="12"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>
                        
                        <StackPanel Grid.Column="0">
                            <TextBlock Style="{StaticResource FieldLabel}" Text="Marka"/>
                            <TextBox Text="{Binding NewAssetBrand, UpdateSourceTrigger=PropertyChanged}"
                                    Style="{StaticResource ModernInput}"/>
                        </StackPanel>
                        
                        <StackPanel Grid.Column="2">
                            <TextBlock Style="{StaticResource FieldLabel}" Text="Model"/>
                            <TextBox Text="{Binding NewAssetModel, UpdateSourceTrigger=PropertyChanged}"
                                    Style="{StaticResource ModernInput}"/>
                        </StackPanel>
                    </Grid>
                    
                    <!-- Seri No -->
                    <TextBlock Style="{StaticResource FieldLabel}" Text="Seri NumarasÄ±"/>
                    <Grid>
                        <TextBox Text="{Binding NewAssetSerialNumber, UpdateSourceTrigger=PropertyChanged}"
                                Style="{StaticResource ModernInput}" Padding="12,10,40,10"/>
                        <TextBlock Text="ðŸ”" FontSize="16" HorizontalAlignment="Right" 
                                  VerticalAlignment="Center" Margin="0,0,12,0" Opacity="0.5"/>
                    </Grid>
                </StackPanel>
            </Border>

            <!-- ===== SAÄž PANEL: ARIZA ===== -->
            <Border Grid.Column="4" Style="{StaticResource WhiteCard}">
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                        <RowDefinition Height="Auto"/>
                    </Grid.RowDefinitions>
                    
                    <TextBlock Grid.Row="0" Style="{StaticResource SectionHeader}">
                        <Run Text="ðŸ”§" FontSize="18"/>
                        <Run Text=" ARIZA DETAYLARI"/>
                    </TextBlock>
                    
                    <!-- ArÄ±za Bilgileri -->
                    <StackPanel Grid.Row="1">
                        <TextBlock Style="{StaticResource FieldLabel}" Text="ArÄ±za Belirtisi *"/>
                        <TextBox Text="{Binding FaultSymptom, UpdateSourceTrigger=PropertyChanged}"
                                Style="{StaticResource ModernInput}" Margin="0,0,0,12"/>
                        
                        <TextBlock Style="{StaticResource FieldLabel}" Text="DetaylÄ± AÃ§Ä±klama"/>
                        <TextBox Text="{Binding Description, UpdateSourceTrigger=PropertyChanged}"
                                Style="{StaticResource ModernInput}"
                                AcceptsReturn="True" TextWrapping="Wrap"
                                VerticalScrollBarVisibility="Auto"
                                Height="100" Margin="0,0,0,16"/>
                        
                        <!-- Fiziksel Durum -->
                        <TextBlock Style="{StaticResource FieldLabel}" Text="Fiziksel Durum (Ã‡izik, KÄ±rÄ±k vb.)"/>
                        <TextBox Text="{Binding PhysicalCondition, UpdateSourceTrigger=PropertyChanged}"
                                Style="{StaticResource ModernInput}" Margin="0,0,0,16"/>
                    </StackPanel>
                    
                    <!-- Aksesuarlar -->
                    <Border Grid.Row="2" Background="#f8f9fa" CornerRadius="8" Padding="12">
                        <StackPanel>
                            <TextBlock Text="ðŸ“¦ Teslim Edilen Aksesuarlar" FontSize="12" 
                                      FontWeight="SemiBold" Foreground="#7f8c8d" Margin="0,0,0,10"/>
                            <WrapPanel>
                                <CheckBox Content="AdaptÃ¶r / GÃ¼Ã§ KaynaÄŸÄ±" 
                                         IsChecked="{Binding AccessoryAdapter}"
                                         Margin="0,0,16,6"/>
                                <CheckBox Content="Kablo" 
                                         IsChecked="{Binding AccessoryCable}"
                                         Margin="0,0,16,6"/>
                                <CheckBox Content="Kumanda" 
                                         IsChecked="{Binding AccessoryRemote}"
                                         Margin="0,0,16,6"/>
                            </WrapPanel>
                        </StackPanel>
                    </Border>
                </Grid>
            </Border>
        </Grid>

        <!-- ========== FOOTER ========== -->
        <Border Grid.Row="2" Background="#252541" Padding="24,16">
            <Grid>
                <Button Content="âŒ Ä°ptal" 
                       Command="{Binding CancelCommand}"
                       Background="#e74c3c" Foreground="White" BorderThickness="0"
                       HorizontalAlignment="Left"
                       Width="100" Height="44" FontSize="13" Cursor="Hand"/>
                
                <!-- Save Button with Spinner -->
                <Button Command="{Binding SaveFaultTicketCommand}"
                       Background="#27ae60" Foreground="White" BorderThickness="0"
                       HorizontalAlignment="Right"
                       Width="200" Height="48" FontSize="15" FontWeight="Bold" Cursor="Hand">
                    <Button.Style>
                        <Style TargetType="Button">
                            <Setter Property="Content" Value="ðŸ’¾ KAYDI OLUÅžTUR"/>
                            <Style.Triggers>
                                <DataTrigger Binding="{Binding IsSaving}" Value="True">
                                    <Setter Property="Content" Value="â³ Kaydediliyor..."/>
                                    <Setter Property="IsEnabled" Value="False"/>
                                </DataTrigger>
                            </Style.Triggers>
                        </Style>
                    </Button.Style>
                </Button>
            </Grid>
        </Border>
    </Grid>
</Window>
