<UserControl x:Class="KamatekCrm.Views.SuppliersView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             xmlns:materialDesign="http://materialdesigninxaml.net/winfx/xaml/themes"
             mc:Ignorable="d" d:DesignHeight="600" d:DesignWidth="1000">

    <Grid Margin="16">
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="380"/>
            <ColumnDefinition Width="*"/>
        </Grid.ColumnDefinitions>

        <!-- LEFT PANEL: LIST -->
        <materialDesign:Card Grid.Column="0" Margin="0,0,16,0" Padding="0" UniformCornerRadius="8" materialDesign:ElevationAssist.Elevation="Dp2" Background="White">
            <Grid>
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="*"/>
                    <RowDefinition Height="Auto"/>
                </Grid.RowDefinitions>

                <!-- Search Header -->
                <Border Grid.Row="0" Background="#F5F5F5" Padding="16" CornerRadius="8,8,0,0">
                    <TextBox Text="{Binding SearchText, UpdateSourceTrigger=PropertyChanged}"
                             Style="{StaticResource MaterialDesignOutlinedTextBox}"
                             materialDesign:HintAssist.Hint="Tedarikçi Ara..."
                             materialDesign:TextFieldAssist.HasClearButton="True"
                             materialDesign:TextFieldAssist.LeadingIcon="Magnify"
                             Background="White" BorderBrush="#E0E0E0"/>
                </Border>

                <!-- List -->
                <DataGrid Grid.Row="1" ItemsSource="{Binding Suppliers}" SelectedItem="{Binding SelectedSupplier}"
                          AutoGenerateColumns="False" IsReadOnly="True" 
                          CanUserAddRows="False" CanUserDeleteRows="False"
                          HeadersVisibility="Column" GridLinesVisibility="Horizontal"
                          Background="White" BorderThickness="0"
                          materialDesign:DataGridAssist.CellPadding="12,8"
                          materialDesign:DataGridAssist.ColumnHeaderPadding="12,12">
                    <DataGrid.Resources>
                        <Style TargetType="DataGridColumnHeader" BasedOn="{StaticResource MaterialDesignDataGridColumnHeader}">
                            <Setter Property="FontWeight" Value="SemiBold"/>
                            <Setter Property="Foreground" Value="#1A237E"/>
                        </Style>
                    </DataGrid.Resources>
                    <DataGrid.Columns>
                        <DataGridTextColumn Header="FİRMA ÜNVANI" Binding="{Binding CompanyName}" Width="*" ElementStyle="{StaticResource MaterialDesignDataGridTextColumnStyle}"/>
                        <DataGridTextColumn Header="İLGİLİ KİŞİ" Binding="{Binding ContactPerson}" Width="140" ElementStyle="{StaticResource MaterialDesignDataGridTextColumnStyle}"/>
                    </DataGrid.Columns>
                </DataGrid>

                <!-- Add Button -->
                <Button Grid.Row="2" Command="{Binding AddNewCommand}" 
                        Style="{StaticResource MaterialDesignFlatButton}"
                        Height="50" Content="YENİ TEDARİKÇİ EKLE"
                        Background="#E8EAF6" Foreground="#1A237E" FontWeight="Bold"
                        materialDesign:ButtonAssist.CornerRadius="0,0,8,8"/>
            </Grid>
        </materialDesign:Card>

        <!-- RIGHT PANEL: DETAILS -->
        <materialDesign:Card Grid.Column="1" UniformCornerRadius="8" materialDesign:ElevationAssist.Elevation="Dp2" Background="White">
            <Grid>
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="*"/>
                    <RowDefinition Height="Auto"/>
                </Grid.RowDefinitions>

                <!-- Header -->
                <Border Grid.Row="0" Background="#1A237E" Padding="20" CornerRadius="8,8,0,0">
                    <StackPanel Orientation="Horizontal">
                        <materialDesign:PackIcon Kind="Domain" Width="32" Height="32" Foreground="White" VerticalAlignment="Center" Margin="0,0,16,0"/>
                        <StackPanel>
                            <TextBlock Text="{Binding SelectedSupplier.CompanyName, TargetNullValue='TEDARİKÇİ SEÇİNİZ'}" 
                                       FontSize="20" FontWeight="Bold" Foreground="White"/>
                            <TextBlock Text="{Binding SelectedSupplier.ContactPerson, StringFormat='İlgili: {0}', TargetNullValue=''}" 
                                       FontSize="13" Foreground="#E8EAF6" Margin="0,2,0,0"/>
                        </StackPanel>
                    </StackPanel>
                </Border>

                <!-- Tabs -->
                <TabControl Grid.Row="1" Visibility="{Binding SelectedSupplier, Converter={StaticResource NullToVis}}"
                            Style="{StaticResource MaterialDesignTabControl}" Margin="0">
                    <!-- Tab 1: General -->
                    <TabItem Header="GENEL BİLGİLER" Style="{StaticResource MaterialDesignNavigationRailTabItem}">
                        <ScrollViewer Padding="20">
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="20"/>
                                    <ColumnDefinition Width="*"/>
                                </Grid.ColumnDefinitions>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                </Grid.RowDefinitions>

                                <!-- Column 1 -->
                                <StackPanel Grid.Column="0">
                                    <TextBox Text="{Binding SelectedSupplier.CompanyName}" Margin="0,0,0,20"
                                             materialDesign:HintAssist.Hint="Firma Ünvanı *" Style="{StaticResource MaterialDesignFloatingHintTextBox}"/>
                                    
                                    <TextBox Text="{Binding SelectedSupplier.ContactPerson}" Margin="0,0,0,20"
                                             materialDesign:HintAssist.Hint="İlgili Kişi Adı Soyadı" Style="{StaticResource MaterialDesignFloatingHintTextBox}"/>
                                    
                                    <TextBox Text="{Binding SelectedSupplier.PhoneNumber}" Margin="0,0,0,20"
                                             materialDesign:HintAssist.Hint="Telefon Numarası" Style="{StaticResource MaterialDesignFloatingHintTextBox}"/>
                                    
                                    <TextBox Text="{Binding SelectedSupplier.Email}" Margin="0,0,0,20"
                                             materialDesign:HintAssist.Hint="E-Posta Adresi" Style="{StaticResource MaterialDesignFloatingHintTextBox}"/>
                                </StackPanel>

                                <!-- Column 2 -->
                                <StackPanel Grid.Column="2">
                                    <TextBox Text="{Binding SelectedSupplier.Address}" Height="120"
                                             TextWrapping="Wrap" VerticalScrollBarVisibility="Auto" AcceptsReturn="True"
                                             materialDesign:HintAssist.Hint="Açık Adres" Style="{StaticResource MaterialDesignOutlinedTextBox}"/>
                                </StackPanel>
                            </Grid>
                        </ScrollViewer>
                    </TabItem>

                    <!-- Tab 2: Financial -->
                    <TabItem Header="FİNANSAL DETAYLAR" Style="{StaticResource MaterialDesignNavigationRailTabItem}">
                        <Grid Margin="20">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="20"/>
                                <ColumnDefinition Width="*"/>
                            </Grid.ColumnDefinitions>
                            
                            <StackPanel Grid.Column="0">
                                <TextBox Text="{Binding SelectedSupplier.TaxOffice}" Margin="0,0,0,20"
                                         materialDesign:HintAssist.Hint="Vergi Dairesi" Style="{StaticResource MaterialDesignFloatingHintTextBox}"/>
                                
                                <TextBox Text="{Binding SelectedSupplier.TaxNumber}" Margin="0,0,0,20"
                                         materialDesign:HintAssist.Hint="Vergi Kimlik No" Style="{StaticResource MaterialDesignFloatingHintTextBox}"/>
                            </StackPanel>

                            <StackPanel Grid.Column="2">
                                <TextBox Text="{Binding SelectedSupplier.IBAN}" Margin="0,0,0,20"
                                         materialDesign:HintAssist.Hint="IBAN Numarası" Style="{StaticResource MaterialDesignFloatingHintTextBox}"/>
                                
                                <TextBox Text="{Binding SelectedSupplier.Currency, TargetNullValue='TL'}" Margin="0,0,0,20"
                                         materialDesign:HintAssist.Hint="Para Birimi" Style="{StaticResource MaterialDesignFloatingHintTextBox}"/>
                            </StackPanel>
                        </Grid>
                    </TabItem>

                    <!-- Tab 3: History -->
                    <TabItem Header="SİPARİŞ GEÇMİŞİ" Style="{StaticResource MaterialDesignNavigationRailTabItem}">
                        <Grid>
                             <materialDesign:PackIcon Kind="History" Width="64" Height="64" Foreground="#EEE" 
                                                      HorizontalAlignment="Center" VerticalAlignment="Center"/>
                        </Grid>
                    </TabItem>
                </TabControl>

                <!-- Footer / Actions -->
                <Border Grid.Row="2" Padding="16" BorderBrush="#EEE" BorderThickness="0,1,0,0"
                        Visibility="{Binding SelectedSupplier, Converter={StaticResource NullToVis}}">
                    <StackPanel Orientation="Horizontal" HorizontalAlignment="Right">
                        <Button Command="{Binding DeleteCommand}" Content="SİL" Width="100" Margin="0,0,16,0"
                                Style="{StaticResource MaterialDesignOutlinedButton}" 
                                BorderBrush="#D32F2F" Foreground="#D32F2F"/>
                        
                        <Button Command="{Binding SaveCommand}" Width="150"
                                Style="{StaticResource MaterialDesignRaisedButton}" Background="#1A237E" Foreground="White">
                            <StackPanel Orientation="Horizontal">
                                <materialDesign:PackIcon Kind="ContentSave" Margin="0,0,8,0" VerticalAlignment="Center"/>
                                <TextBlock Text="KAYDET" FontWeight="Bold"/>
                            </StackPanel>
                        </Button>
                    </StackPanel>
                </Border>
            </Grid>
        </materialDesign:Card>
    </Grid>
</UserControl>
